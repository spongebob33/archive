<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://kauri.io/single/step-by-step-guide-%22claim-your-dns-domain-on-ens%22/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Step by step guide “Claim your DNS domain on ENS” - kauri.io</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Step by step guide \u201cClaim your DNS domain on ENS\u201d", url: "#_top", children: [
              {title: "0 \u2014 Pre-requisite", url: "#0-pre-requisite" },
              {title: "1 \u2014 Setting up DNSSEC signing", url: "#1-setting-up-dnssec-signing" },
              {title: "2 \u2014 Adding a TXT record", url: "#2-adding-a-txt-record" },
              {title: "3 \u2014 Interacting with the DNSSEC oracle", url: "#3-interacting-with-the-dnssec-oracle" },
              {title: "4\u2014 Claiming your domain in ENS", url: "#4-claiming-your-domain-in-ens" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-172017815-1', 'kauri.io');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    <h1 id="step-by-step-guide-claim-your-dns-domain-on-ens">Step by step guide “Claim your DNS domain on ENS”<a class="headerlink" href="#step-by-step-guide-claim-your-dns-domain-on-ens" title="Permanent link"></a></h1>
<hr />
<p>This is a note I took while setting up <strong>matoken.xyz</strong> ENS address using NameCheap and Google Cloud DNS. Before continuing this blog post, make sure you read the original post by <a href="https://medium.com/@weka">Nick Johnson</a> 
Nick’s blog post is fairly concise and well written for people who have good understanding of how to administer DNS. If you are not so familiar with administering DNS like me, then this step by step guide with plenty of screenshots may help.
(Warning: readers are expected to know how to work with command line tools and git).</p>
<h3 id="0-pre-requisite">0 — Pre-requisite<a class="headerlink" href="#0-pre-requisite" title="Permanent link"></a></h3>
<p>Before starting this, make sure you have the following.</p>
<ul>
<li>
<p><a href="https://github.com/ethereum/go-ethereum">go Ethereum</a> installed on your local machine (Parity may work but I haven’t tried). Your node does not necessarily have to be in sync.</p>
</li>
<li>
<p>Ethereum account for “ <strong>Ropsten</strong> ” testnet with some Ether preloaded (NOTE: Ethereum account generated from Metamask won’t work as of writing this article).</p>
</li>
<li>
<p>.xyz registered domain and have admin access to change its record (I suggest creating a new domain rather than using your live domain so that you can mess with things. You can get the domain as low as £0.71 for the first year from NameCheap)</p>
</li>
</ul>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*uTfgoMNQb3zT0JuW7LdnPg.png" /></p>
<h3 id="1-setting-up-dnssec-signing">1 — Setting up DNSSEC signing<a class="headerlink" href="#1-setting-up-dnssec-signing" title="Permanent link"></a></h3>
<pre><code>Depending on your DNS provider, this may be really easy, or quite involved.
</code></pre>
<p>This is what Nick mentioned in the very beginning. I spent almost half a day figuring out but once you know it all, probably only takes 30 min to actually do it.
 <strong>1.1 Does NameCheap supports DNSSEC?</strong> 
To figure that out, I read this article.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*Ou32-VsLUpOfwyi7q_u3BQ.png" /></p>
<p>Luckily <code>.xyz</code> domain is one of 14 domains NameCheap supports and enabling DNSSEC is as easy as sliding right… that’s what I thought at first.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*oO7pPnAlkLLlQIPO5EjZmw.png" /></p>
<p><strong>1.2 Does NameCheap support the SHA256?</strong> </p>
<pre><code>Whatever provider you need, make sure you select RSA signatures and SHA256 hashing.
</code></pre>
<p>When you see your domain info using Verisign’s <a href="https://dnssec-debugger.verisignlabs.com">DNSSEC debugger</a> , it tells you which algorithm each layer of DNS provider uses.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*tvSonCBUInDxB3z4ol59lQ.png" /></p>
<p>Unfortunately, NameCheap uses ECDSAP256SHA256 for signing messages rather than RSASHA256. I couldn’t find any option to change that from NameCheap admin panel. I initially thought that I have to get another .xyz domain from <a href="https://domains.google">Google domains</a> (later found out they don’t sell .xyz domain) but he suggested to just change DNS provider.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*FK5Zq7tpmPHrXxx-JFBzxQ.png" /></p>
<p>It turned out that it is relatively easy to specify “Custom DNS” from NameCheap admin panel rather than using their own DNS servers.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*Dc6TWeTZI7ZBYRZ2i40uew.png" /></p>
<p><strong>1.3 Use Google Cloud DNS as custom DNS</strong> 
The good news is that Google recently started supporting DNSSEC.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*oS5K64ruWlU6DjggrKVonQ.png" /></p>
<p>Setting up DNS from Google Cloud public DNS was quite easy. You just fill in “Zone name” (just an identifier you can make it up), DNS name (the domain name you purchased from NameCheap), then enable DNSSEC “ON”.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*60QIs2majpxk8Y2Rwax6oQ.png" /></p>
<p>Once created, it will show the list of Google Cloud DNS server names which you can copy &amp; past to your NameCheap admin panel.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*U_waiiei7D_ow2dzWYRJ_Q.png" /></p>
<p><strong>1.4 Point Name Name servers to Google Cloud DNS from NameCheap control panel</strong> 
Now go back to your NameCheap control panel and choose “Custom DNS” which allows you to add name servers you saw from Google Cloud DNS</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*Dc6TWeTZI7ZBYRZ2i40uew.png" /></p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*cjP39Ge7mTqoy5Wqw-1D_w.png" /></p>
<p><strong>1.5 Add DS Record</strong> 
Is this it? Not quite. When I looked into <a href="https://dnssec-debugger.verisignlabs.com/matoken.xyz">https://dnssec-debugger.verisignlabs.com/matoken.xyz</a> for the first time, I saw one error message.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*OrpanJVdRQ2YIOQtoY7rug.png" /></p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*9ruPItwEVB0i9py_ghKXyg.png" /></p>
<p>Ah, I have to somehow tell NameCheap about something called “ <strong>DS Record</strong> ”. DS stands for “Delegation of Signing” and it provides information about a signed zone file(which you created at Google Cloud DNS). Enabling DNSSEC requires this information to complete the setup of your signed domain name (NameCheap).
It took a while to find out where DS Record is on Google Cloud DNS panel. but clicking “Registar Setup” will get you to the necessary info.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*fBpfbXQbug_3A3n_GJQ5dw.png" /></p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*2OVxC3Nfsn5TAAAxRGNGZg.png" /></p>
<p>Now go back to NameCheap and activate “DNSSEC” toggling button. It will show you DS record input field which you can paste from Google Cloud DNS.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*xyyGar4LNBjcX4xw6H91KQ.png" /></p>
<p>I probably waited 15 ~ 20 min for the record to be reflected on <a href="https://dnssec-debugger.verisignlabs.com/matoken.xyz">https://dnssec-debugger.verisignlabs.com/matoken.xyz</a> </p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*3m---vljRJ5JtQpTARUw_Q.png" /></p>
<p>You just finished the hardest part. The rest is relatively easy compared to what you have done so far.</p>
<h3 id="2-adding-a-txt-record">2 — Adding a TXT record<a class="headerlink" href="#2-adding-a-txt-record" title="Permanent link"></a></h3>
<pre><code>To claim ownership of mydomain.xyz, create a TXT record in your DNS zone, _ens.mydomain.xyz, with text data of the form a=0x1234..., where 0x1234... is the Ethereum address you want to give control of the ENS record to.
</code></pre>
<p>This part is relatively straight forward. TXT is a type of DNS record literally provides the ability to associate arbitrary <strong>text</strong> with a host or other name. This is a bit similar how <a href="https://faucet.rinkeby.io/">https://faucet.rinkeby.io</a> request you to tweet with your Ethereum address so that you can prove that the twitter account owns the specific Ethereum address.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*mMskHCxnrLRqZSEvRpUsBw.png" /></p>
<h3 id="3-interacting-with-the-dnssec-oracle">3 — Interacting with the DNSSEC oracle<a class="headerlink" href="#3-interacting-with-the-dnssec-oracle" title="Permanent link"></a></h3>
<p><strong>3.1 Setup go environment</strong> 
This part may be super easy if you use golang day to day. I don’t code golang but my Mac already had it installed. Maybe it was installed when I installed go-ethereum ? If golang is installed, you have to set two environment variable, GOROOT, GOPATH, put $GOROOT/bin into your $PATH, then create a folder with <code>src</code> , <code>bin</code> , and <code>pkg</code> folder</p>
<pre><code>[~/src/dnsprove -  (master)] $ which go
/usr/local/bin/go
[~/src/dnsprove -  (master)] $ go version
go version go1.10 darwin/amd64
[~/src/dnsprove -  (master)] $ mkdir ~/work/golang
[~/src/dnsprove -  (master)] $ mkdir ~/work/golang/{src,bin,pkg}
[~/src/dnsprove -  (master)] $ echo export GOROOT=/usr/local/opt/go/libexec &gt;&gt; ~/.bash_profile
[~/src/dnsprove -  (master)] $ echo export GOPATH=$HOME/work/golang  &gt;&gt; ~/.bash_profile 
[~/src/dnsprove -  (master)] $ echo export PATH=$PATH:$GOROOT/bin:$GOPATH/bin &gt;&gt; ~/.bash_profile 
[~] $ . ~/.bash_profile 
[~] $ cd $GOPATH


</code></pre>
<p><strong>3.2 Install dnsprove</strong> 
 <code>go get</code> is go equivalent to <code>npm install</code> for node.js or <code>bundle install</code> for Ruby. After taking a while, you should see <code>dnsprove</code> command under <code>$GOROOT/bin</code> directory.</p>
<pre><code>[~/work/golang] $ cd src/
[~/work/golang/src] $ git clone https://github.com/arachnid/dnsprove
Cloning into 'dnsprove'...
remote: Counting objects: 24, done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 24 (delta 0), reused 3 (delta 0), pack-reused 18
Unpacking objects: 100% (24/24), done.
[~/work/golang/src] $ cd ..
[~/work/golang] $ go get
[~/work/golang] $ ls src/github.com/arachnid/dnsprove/
LICENSE     README.md   dnsprove.go oracle      proofs
[~/work/golang] $ ls bin/
dnsprove


</code></pre>
<p><strong>3.3 run dnsprove</strong> 
I usually use <code>rinkeby</code> testnet so <code>rostpen</code> was not in sync. I initially tried to sync with <code>--light</code> but it often fails to find a peer node to sync. To work it around, you can use Infura RPC end point.</p>
<pre><code>bin/dnsprove --rpc=&quot;https://ropsten.infura.io&quot;  --address=0xd7296b6044ffd0565062345c2eaa4017024b2d22 --keyfile=YOUROWNKEYFILE TXT _ens.matoken.xyz.
</code></pre>
<p>Until this far, I was using an Ethereum address generated by Metamask, but I realised that I have to pass <code>--keyfile</code> which Metamask does not have. That’s why I mentioned at the pre-requisite section that your account has to be generated with geth so that it has keyfile.
Anyway, if all goes well, it should see the following output (it also asks to send 4 transactions).</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*COVMYcwQj5kauXWGfvjvCA.png" /></p>
<h3 id="4-claiming-your-domain-in-ens">4— Claiming your domain in ENS<a class="headerlink" href="#4-claiming-your-domain-in-ens" title="Permanent link"></a></h3>
<p>In Nick’s original post, he assumed that you have local geth node in sync so that you can claim the domain from geth console. However, I used Infura remote node so my local node is not in sync? How do I work around?
 <strong>4.1 Encode your name through node console.</strong> 
The workaround Nick suggested was to first generate the encoded string from node console then copy &amp; paste the outcome to <a href="http://mycrypto.com">MyCrypto</a> .</p>
<pre><code>[~/work/golang/src/dnsprove -  (master)] $ node
</code></pre>
<pre><code>&gt; function encodeName(buf, off, name) {
  if(name == &quot;.&quot;) {
    buf.writeUInt8(0, off++);
    return off;
  }
</code></pre>
<pre><code>for(var part of name.split(&quot;.&quot;)) {
    buf.writeUInt8(part.length, off++);
    buf.write(part, off)
    off += part.length;
  }
  return off;
}
</code></pre>
<pre><code>function hexEncodeName(name) {
  if(!name.endsWith(&quot;.&quot;)) name = name + &quot;.&quot;;
  var buf = new Buffer(name.length + 1);
  var off = encodeName(buf, 0, name);
  return &quot;0x&quot; + buf.toString(&quot;hex&quot;, 0, off);
}
</code></pre>
<pre><code>undefined
</code></pre>
<pre><code>&gt;  hexEncodeName(&quot;matoken.xyz&quot;)
</code></pre>
<pre><code>'0x076d61746f6b656e0378797a00'
</code></pre>
<pre><code>&gt;
</code></pre>
<p><strong>4.2 Call</strong>  <code>claim</code>  <strong>function from MyCrypto</strong> 
Once the name was encoded, go to MyCrypto, copy the Contract Address and ABI interface</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*GXamO32F_fSw1lCoOHutfA.png" /></p>
<p>Once MyCrypto recognise the ENS contract, you can pick <code>claim</code> function with passing the encoded name as an argument.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*pXf8Z4n-zVqj927HC5NeDA.png" /></p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*Gimbd2eKzKCt9fJ4fwpllQ.png" /></p>
<p><strong>4.3 Verify the result</strong> 
Once the transaction is confirmed, Go to <a href="https://manager.ens.domains">manager.ens.domains</a> with network pointed to <strong>Ropsten</strong> network.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/1600/1*Z4CGD3ZxKgDXqQ1jLOVpKg.png" /></p>
<p>Tada! You can see that <code>matoken.xyz</code> is assigned to the owner name I added onto TXT record on Google Cloud DNA.
 <strong>Conclusion</strong> 
Currently it is still quite a lengthy process, but it is cools to be able to claim ENS address tied into your DNS name. I encourage you to try out with different providers and share the knowledge so that it will be easier for ENS team to come up ways to make your on boarding process a lot easier.
(Special thanks to <a href="https://medium.com/@weka">Nick Johnson</a> for helping me completing this work and also reviewing this blog post).</p>
<hr />
<ul>
<li><strong>Kauri original title:</strong> Step by step guide “Claim your DNS domain on ENS”</li>
<li><strong>Kauri original link:</strong> https://kauri.io/step-by-step-guide-claim-your-dns-domain-on-ens/02de92af458b488a98379870ae9a91ae/a</li>
<li><strong>Kauri original author:</strong> Makoto Inoue (@makoto)</li>
<li><strong>Kauri original Publication date:</strong> 2018-10-30</li>
<li><strong>Kauri original tags:</strong> none</li>
<li><strong>Kauri original hash:</strong> QmYuy5BVc3Kij5uayVjhmnB366FHc3YjM9Krwpm8vabkXA</li>
<li><strong>Kauri original checkpoint:</strong> QmRS3wCLX2MRi62bg9NTM89qNkgm3XjpKXciLvCKAr1f1g</li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../merchant-gateway-for-xdai-buffidai-and-other-burn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../merchant-gateway-for-xdai-buffidai-and-other-burn/" class="btn btn-xs btn-link">
        Merchant Gateway for xDai, BuffiDai, and other burner wallet currencies
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../marketwatch-crypto-exchange-monitor/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../marketwatch-crypto-exchange-monitor/" class="btn btn-xs btn-link">
        MarketWatch - Crypto Exchange Monitor
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/kauri-io/archive/edit/main/docs/single/step-by-step-guide-"claim-your-dns-domain-on-ens".md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>