<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://kauri.io/communities/IPFS/hands-on-ipld-tutorial-in-golang--part-2/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Hands-on IPLD Tutorial in Golang  PART 2 - kauri.io</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Hands-on IPLD Tutorial in Golang  PART 2", url: "#_top", children: [
              {title: "Quick recap from PART-1", url: "#quick-recap-from-part-1" },
              {title: "What We Will Learn from PART-2? \ud83e\udd14", url: "#what-we-will-learn-from-part-2" },
              {title: "Changing the Data Structures \ud83d\udee0", url: "#changing-the-data-structures" },
              {title: "Changing the Way We Track Entries \ud83e\uddd0", url: "#changing-the-way-we-track-entries" },
              {title: "Taking User Input \ud83d\udc68\u200d\ud83d\udcbb\ud83d\udc69\u200d\ud83d\udcbb", url: "#taking-user-input" },
              {title: "The Document-Storage Magic \ud83d\udd2e\u2728", url: "#the-document-storage-magic" },
              {title: "A Change in Reading DAGs for Entries", url: "#a-change-in-reading-dags-for-entries" },
              {title: "Conclusion", url: "#conclusion" },
              {title: "About the Authors:", url: "#about-the-authors" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-172017815-1', 'kauri.io');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    <h1 id="hands-on-ipld-tutorial-in-golang-part-2">Hands-on IPLD Tutorial in Golang  PART 2<a class="headerlink" href="#hands-on-ipld-tutorial-in-golang-part-2" title="Permanent link">ÔÉÅ</a></h1>
<p><img alt="" src="https://ipfs.infura.io/ipfs/QmVo6CzDQJc5KYz64yxTKcWqpofSTjRHme6pgqeRE8BUCk" /></p>
<p>This article was first published on our open-source platform, <a href="https://simpleaswater.com/hands-on-ipld-tutorial-in-golang-2/?ref=kauri">SimpleAsWater.com</a>. If you are interested in IPFS, Libp2p, Ethereum, Zero-knowledge Proofs, DeFi, CryptoEconomics, IPLD, Multiformats, and other Web 3.0 projects, concepts and interactive tutorials, then be sure to check out <a href="https://simpleaswater.com?ref=kauri">SimpleAsWater</a>.</p>
<hr />
<h4 id="quick-recap-from-part-1">Quick recap from PART-1<a class="headerlink" href="#quick-recap-from-part-1" title="Permanent link">ÔÉÅ</a></h4>
<p>Before we explore how to use IPLD for document store based interface, have you read the PART 1 of this series yet? Here's the link to PART 1 in case you want to catch up! </p>
<p><a href="https://simpleaswater.com/hands-on-ipld-tutorial-in-golang-2/?ref=kauri">Getting Started with IPLD: Hands-on IPLD Tutorial in Golang: PART 1</a></p>
<p><strong><em>TLDR:</em></strong> In PART 1 , we explored the basic concepts of IPLD, how it is used in IPFS. We also scratched the surface by building a key-value based database interface on IPFS using IPLD. </p>
<h4 id="what-we-will-learn-from-part-2">What We Will Learn from PART-2? ü§î<a class="headerlink" href="#what-we-will-learn-from-part-2" title="Permanent link">ÔÉÅ</a></h4>
<p>In PART 2 of the series, we will directly dive into the coding and see how to enhance the functionality to build a document storage (similar to MongoDB and other document databases). </p>
<p><strong><em>If you get stuck in any part or have any queries/doubts, then feel free to reach us out on our <a href="https://discord.gg/x2kmUXW">discord channel</a>.</em></strong></p>
<p>Here is final shown down üòé </p>
<p><img alt="Final IPLD Document Store in Golang" src="https://asciinema.org/a/293822.svg" /></p>
<h4 id="changing-the-data-structures">Changing the Data Structures üõ†<a class="headerlink" href="#changing-the-data-structures" title="Permanent link">ÔÉÅ</a></h4>
<p>In contrast to PART 1, our data structure will be a structure which will be further mapped by a <code>string</code> type key. Each document entry we store is of the following format. This is very similar to how you develop schemas: </p>
<pre><code class="language-go">// SampleStruct defines the benchmark payload
type SampleStruct struct {
    ID     string `json:&quot;ID&quot;`
    Name   string `json:&quot;Name&quot;`
    Salary string `json:&quot;Salary&quot;`
}

</code></pre>
<p>As shown above, we have defined <code>SampleStruct</code>, which defines three fields representing an employee's data record. This means, we can contain each employee's <code>ID</code>, <code>Name</code> and corresponding <code>Salary</code> amount in the structure's instances. </p>
<h4 id="changing-the-way-we-track-entries">Changing the Way We Track Entries üßê<a class="headerlink" href="#changing-the-way-we-track-entries" title="Permanent link">ÔÉÅ</a></h4>
<p>Further, we need to manage this relationship in a mapping by it's own <code>ID</code> to facilitate Read or Lookup operations for each employee record. Hence, we update the current mapping as follows: </p>
<pre><code class="language-go">// Map the struct instance it's own ID
DocStoreMap := make(map[string]SampleStruct)

</code></pre>
<h4 id="taking-user-input">Taking User Input üë®‚Äçüíªüë©‚Äçüíª<a class="headerlink" href="#taking-user-input" title="Permanent link">ÔÉÅ</a></h4>
<p>Now, we can ask users to enter the values for all the three fields as defined in the <code>SampleStruct</code>. Once we have the value for all the three fields (namely <code>ID</code>, <code>Name</code> and <code>Salary</code>), we can initiate an object/instance based on the definition and assign the received values as follows: </p>
<pre><code class="language-go">scanner := bufio.NewScanner(os.Stdin)

fmt.Println(&quot;Enter the ID of the employee: &quot;)
scanner.Scan()
inputID := scanner.Text()

fmt.Println(&quot;Enter the name of the employee: &quot;)
scanner.Scan()
inputName := scanner.Text()

fmt.Println(&quot;Enter the salary of the employee: &quot;)
scanner.Scan()
inputSalary := scanner.Text()

// Create a struct instance and assign the input values to the corresponding fields
employeeObject := SampleStruct{ID: inputID, Name: inputName, Salary: inputSalary}

</code></pre>
<h4 id="the-document-storage-magic">The Document-Storage Magic üîÆ‚ú®<a class="headerlink" href="#the-document-storage-magic" title="Permanent link">ÔÉÅ</a></h4>
<p>Once the object is created and the captured values are assigned, we can map the same object in the mapping by it's own <code>ID</code> value. Once the mapping is updated, we can now write it to the Merkle DAG as follows: </p>
<pre><code class="language-go">// Map the struct instance to the mapping
DocStoreMap[inputID] = employeeObject

// Converting the map into JSON object
entryJSON, err := json.Marshal(DocStoreMap)
if err != nil {
    fmt.Println(err)
}

// Display the marshaled JSON object before sending it to IPFS
jsonStr := string(entryJSON)
fmt.Println(&quot;The JSON object of your document entry is:&quot;)
fmt.Println(jsonStr)

start := time.Now()
// Dag PUT operation which will return the CID for futher access or pinning etc.
cid, err := sh.DagPut(entryJSON, &quot;json&quot;, &quot;cbor&quot;)
elapsed := time.Since(start)
if err != nil {
    fmt.Fprintf(os.Stderr, &quot;error: %s&quot;, err)
    os.Exit(1)
}

</code></pre>
<p>If you are scratching your heading thinking what does a DAG means &amp; what does <code>DagPut</code> function do, then we recommend going through the PART 1 of the series. </p>
<p>We have now successfully written the mapping to the IPLD DAG and a CID may be returned. Yayüéâüéâ </p>
<h4 id="a-change-in-reading-dags-for-entries">A Change in Reading DAGs for Entries<a class="headerlink" href="#a-change-in-reading-dags-for-entries" title="Permanent link">ÔÉÅ</a></h4>
<p>Now, we must update our code to read the document from the mapping. In contrast to PART 1, the read operation will not be returning a mere single-value. It will be returning the whole JSON document as defined in the schema. Hence, we update the getter function by changing the return type as follows: </p>
<pre><code class="language-go">// GetDocument handles READ operations of a DAG entry by CID, returning the corresponding document
func GetDocument(ref, key string) (out SampleStruct, err error) {
    err = sh.DagGet(ref+&quot;/&quot;+key, &amp;amp;out)
    return
}

</code></pre>
<p>Now, let us call this getter/read function in main.go as follows: </p>
<pre><code class="language-go">// Fetch the details by reading the DAG for key &quot;inputKey&quot;
fmt.Printf(&quot;READ: Reading the document details of employee by ID: \&quot;%s\&quot;\n&quot;, inputID)
start = time.Now()
document, err := GetDocument(cid, inputID)
elapsed = time.Since(start)
if err != nil {
    fmt.Println(err)
}

fmt.Printf(&quot;READ: Salary of employee ID %s is %s\n&quot;, string(inputID), string(document.Salary))

</code></pre>
<p>As shown above, the <code>GetDocument</code> is passed with the <code>ID</code> value which was earlier entered by the user. Based on the <code>ID</code> value, the corresponding document is returned from the mapping.
Once the document is returned, we can parse it as required and print the <code>Salary</code> of the inquired employee. </p>
<h4 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">ÔÉÅ</a></h4>
<p>We hope you had fun learning how to enhance the code to support document storage. Go crazy and build your own decentralized document database ! ü§™ </p>
<p><strong><em>If you get stuck in any part or have any queries/doubts, then feel free to reach us out on our <a href="https://discord.gg/x2kmUXW">discord channel</a>.</em></strong></p>
<p>And here is the link to the <a href="https://github.com/0zAND1z/ipld-crud"><strong>full implementation of the code on GitHub</strong></a>. </p>
<h3 id="about-the-authors">About the Authors:<a class="headerlink" href="#about-the-authors" title="Permanent link">ÔÉÅ</a></h3>
<h4 id="ganesh-prasad-kumble">Ganesh Prasad Kumble<a class="headerlink" href="#ganesh-prasad-kumble" title="Permanent link">ÔÉÅ</a></h4>
<p><img alt="Ganesh Prasad Kumble profile pic" src="https://simpleaswater.com/content/images/2020/01/image-30.png" /></p>
<p>Ganesh is an expert in emerging technologies and business strategy. He has co-founded, bootstrapped, mentored several start-ups and initiatives across SaaS, eCommerce, IoT, Blockchain &amp; AI. </p>
<p>He is a contributor to several open-source projects including Ethereum and IPFS. He is also a moderator at the Ethereum Research forum. </p>
<p>Ganesh is currently leading Platform Innovation efforts at <a href="https://www.aicumen.com/">Aicumen Technologies Inc.</a> &amp; <a href="https://www.kip.foundation/">KIP Foundation</a>, building a general purpose business protocol featuring identity management, third party services, distributed compute and immutable storage. </p>
<p>He is also the author of the <a href="https://www.amazon.com/dp/B07X42XFD3/ref=cm_sw_su_dp">Hands-on Artificial Intelligence for Blockchain</a> book. </p>
<h4 id="vaibhav-saini">Vaibhav Saini<a class="headerlink" href="#vaibhav-saini" title="Permanent link">ÔÉÅ</a></h4>
<p>Vaibhav Saini is Co-founder of <a href="https://signy.io?ref=kauri">TowardsBlockchain</a>, <a href="https://dappkit.io?ref=kauri">Dappkit</a> &amp; <a href="https://simpleaswater.com?ref=kauri">SimpleAsWater</a>. You can know more about him <a href="https://www.linkedin.com/in/vasadev/">here</a>. </p>
<hr />
<ul>
<li><strong>Kauri original title:</strong> Hands-on IPLD Tutorial in Golang  PART 2</li>
<li><strong>Kauri original link:</strong> https://kauri.io/handson-ipld-tutorial-in-golang-part-2/5fa2dc4be27b433d86d571ba857ab02d/a</li>
<li><strong>Kauri original author:</strong> Vaibhav Saini (@vasa)</li>
<li><strong>Kauri original Publication date:</strong> 2020-01-16</li>
<li><strong>Kauri original tags:</strong> merkle-trees, ipfs, simpleaswater, golang, dag, ipld</li>
<li><strong>Kauri original hash:</strong> QmZCduoHvo99ASHkrdeajztZTavQb5rcR1rmp8GY9gxUHg</li>
<li><strong>Kauri original checkpoint:</strong> QmUP9qZg9vxiTYmDyCRfVzpyYLQbtd6r3GAM7CyqCFhShv</li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../understanding-ipfs-in-depth%2826%29--what-is-interpla/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../understanding-ipfs-in-depth%2826%29--what-is-interpla/" class="btn btn-xs btn-link">
        Understanding IPFS in Depth(2/6)  What is InterPlanetary Linked Data(IPLD)?
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../building-a-twitter-bot-using-ipfs-cluster/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../building-a-twitter-bot-using-ipfs-cluster/" class="btn btn-xs btn-link">
        Building a Twitter Bot using IPFS Cluster ü§ñ
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/kauri-io/archive/edit/main/docs/communities/IPFS/hands-on-ipld-tutorial-in-golang--part-2.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>