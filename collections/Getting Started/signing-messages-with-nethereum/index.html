<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://kauri.io/collections/Getting%20Started/signing-messages-with-nethereum/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Signing messages with Nethereum - kauri.io</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Signing messages with Nethereum", url: "#_top", children: [
              {title: "Ethereum signing basics", url: "#ethereum-signing-basics" },
              {title: "Signing messages and verifying signatures with Nethereum", url: "#signing-messages-and-verifying-signatures-with-nethereum" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-172017815-1', 'kauri.io');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    <h1 id="signing-messages-with-nethereum">Signing messages with Nethereum<a class="headerlink" href="#signing-messages-with-nethereum" title="Permanent link"></a></h1>
<p>The purpose of this article is to help .NET developers leverage  <a href="https://nethereum.com/">Nethereum</a>, An open source .NET integration library for blockchain.</p>
<p>This document also exists as a <a href="https://github.com/Nethereum/Nethereum.Workbooks/blob/master/docs/nethereum-signing-messages.workbook"> Workbook </a>, find more about workbooks installation requirements  <a href="https://docs.microsoft.com/en-us/xamarin/tools/workbooks/install">here</a></p>
<p>Nethereum provides methods to sign messages in an Ethereum compatible format. The following is a quick guide to signing a string with Nethereum and verifying a signature using various methods.</p>
<h3 id="ethereum-signing-basics">Ethereum signing basics<a class="headerlink" href="#ethereum-signing-basics" title="Permanent link"></a></h3>
<p>In the Ethereum context, signing a message allows us to verify that a piece of data was signed by a specific account, in other terms, it's a way to prove to a smart contract/human that an account approved a message.</p>
<p>Signing a message with a private key does not require interacting with the Ethereum network. It can be done completely offline, hence the following code can be run without a testchain.</p>
<p>Nethereum provides with a class that can be used to sign or verify messages: <code>EthereumMessageSigner</code>.
Let's now explore how to use <code>EthereumMessageSigner</code> with two very common scenarios in the Ethereum context.</p>
<h3 id="signing-messages-and-verifying-signatures-with-nethereum">Signing messages and verifying signatures with Nethereum<a class="headerlink" href="#signing-messages-and-verifying-signatures-with-nethereum" title="Permanent link"></a></h3>
<p>Let's first reference our assemblies and namespaces:</p>
<pre><code class="language-csharp">##r &quot;Nethereum.Web3&quot;
</code></pre>
<pre><code class="language-csharp">##r &quot;Nethereum.ABI&quot;
</code></pre>
<pre><code class="language-csharp">using Nethereum.Web3;
using Nethereum.Util;
using System.Collections.Generic;
using System.Text;
using Nethereum.Signer;
using Nethereum.Hex.HexConvertors.Extensions;
using Nethereum.ABI.Encoders;
</code></pre>
<p>Now let's declare elements that we will in every of our examples:</p>
<p><strong>address</strong> declares the signer's account address:</p>
<pre><code class="language-csharp">var address = &quot;0x12890d2cce102216644c59dae5baed380d84830c&quot;;
</code></pre>
<p><strong>msg1</strong> declares the content of the message itself, here is a simple string:</p>
<pre><code class="language-csharp">var msg1 = &quot;wee test message 18/09/2017 02:55PM&quot;;
</code></pre>
<p><strong>privatekey</strong> declares the private key of the signer’s <strong>account</strong>:</p>
<pre><code class="language-csharp">var privateKey = &quot;0xb5b1870957d373ef0eeffecc6e4812c0fd08f554b37b233526acc331bf1544f7&quot;;
</code></pre>
<p><strong>signer1</strong> creates an instance of the <strong>EthereumMessageSigner</strong> object:</p>
<pre><code class="language-csharp">var signer1 = new EthereumMessageSigner();
</code></pre>
<h4 id="1-encoding-and-signing-a-message-using-encodeutf8andsign">1-Encoding and signing a message using EncodeUTF8AndSign:<a class="headerlink" href="#1-encoding-and-signing-a-message-using-encodeutf8andsign" title="Permanent link"></a></h4>
<p>The most common scenario when signing a message goes as follows:</p>
<p>A message needs to be signed, it's most likely a string and hence can be encoded in UTF8 and then signed, therefore we will use <code>EncodeUTF8AndSign</code></p>
<p><code>EncodeUTF8AndSign</code> requires two arguments:</p>
<ul>
<li>
<p>The message itself</p>
</li>
<li>
<p>The signing account's private key</p>
</li>
</ul>
<pre><code class="language-csharp">var signature1 = signer1.EncodeUTF8AndSign(msg1, new EthECKey(privateKey));
</code></pre>
<h4 id="2-verifying-a-signed-message-encoded-in-utf8-using-encodeutf8andecrecover">2- Verifying a signed message encoded in UTF8 using EncodeUTF8AndEcRecover:<a class="headerlink" href="#2-verifying-a-signed-message-encoded-in-utf8-using-encodeutf8andecrecover" title="Permanent link"></a></h4>
<p>The Ethereum signature verification process is a bit different from classical digital signatures, here the output of a signature verification is not the message (or the message hash) but the signer's address, since the address is a part of the public key hash.
Verification is successful if the recovered address is equal to the provided address, which can only happen if the signer is the owner of the account's private key.</p>
<p>In this case the <strong>EncodeUTF8AndEcRecover</strong> method is used to verify the signer's address of a message encoded in UTF8:</p>
<p><strong>addressRec1</strong> evaluates to the signer's address, thus proving the validity of the message.</p>
<pre><code class="language-csharp">var addressRec1 = signer1.EncodeUTF8AndEcRecover(msg1, signature1);
</code></pre>
<h4 id="3-hashing-and-signing-a-message-using-hashandsign">3-Hashing and signing a message using <strong>HashAndSign</strong>:<a class="headerlink" href="#3-hashing-and-signing-a-message-using-hashandsign" title="Permanent link"></a></h4>
<p>In some cases, hashing data and then signing it might be more relevant, i.e. when dealing with a large file.</p>
<p><strong>HashAndSign</strong> enables you to do this in one go:</p>
<pre><code class="language-csharp">var msg2 = &quot;test&quot;;
var signer2 = new EthereumMessageSigner();
var signature2 = signer2.HashAndSign(msg2,
                &quot;0xb5b1870957d373ef0eeffecc6e4812c0fd08f554b37b233526acc331bf1544f7&quot;);
</code></pre>
<h4 id="4-verifying-a-hashed-message-using-hashandecrecover">4-Verifying a hashed message using <strong>HashAndEcRecover</strong>:<a class="headerlink" href="#4-verifying-a-hashed-message-using-hashandecrecover" title="Permanent link"></a></h4>
<p>When receiving a signature that has been made with a hashed file it's necessary to start by hashing the file we want to verify and then recover the address that signed it.</p>
<p><strong>HashAndEcRecover</strong> enables you to do this in one single step:</p>
<pre><code class="language-csharp">var addressRec2 = signer2.HashAndEcRecover(msg2, signature2);
</code></pre>
<p>For more support get in touch with our community:  https://gitter.im/Nethereum/Nethereum</p>
<hr />
<ul>
<li><strong>Kauri original title:</strong> Signing messages with Nethereum</li>
<li><strong>Kauri original link:</strong> https://kauri.io/signing-messages-with-nethereum/feb122418c014c8bb7010063263d0a20/a</li>
<li><strong>Kauri original author:</strong> Gaël Blanchemain  (@anegg0)</li>
<li><strong>Kauri original Publication date:</strong> 2019-06-06</li>
<li><strong>Kauri original tags:</strong> ethereum, encryption, -net, nethereum, tutorial</li>
<li><strong>Kauri original hash:</strong> QmUWoti4Lr95GRAapp9HFuEnzmzozjA1CTNrSBF1GT5jV2</li>
<li><strong>Kauri original checkpoint:</strong> QmRS3wCLX2MRi62bg9NTM89qNkgm3XjpKXciLvCKAr1f1g</li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../managing-nonces-with-nethereum/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../managing-nonces-with-nethereum/" class="btn btn-xs btn-link">
        Managing nonces with Nethereum
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../smart-contracts-integration-with-nethereum/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../smart-contracts-integration-with-nethereum/" class="btn btn-xs btn-link">
        Smart contracts integration with Nethereum
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/kauri-io/archive/edit/main/docs/collections/Getting Started/signing-messages-with-nethereum.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>